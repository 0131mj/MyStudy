

# Variable : 변수



## 1. 용어 : 변수(variable) 와 식별자 (identifier)

- 변수명은 다른 말로 식별자라고 부르기도 한다. 
- '변수' 가 아니라, '변수명' 이 식별자이다.



## 2. 자바스크립트 변수 할당 및 변경 원리

자바스크립트의 변수 스코프를 이해하기 위해서는 자바스크립트가 실행되는 과정에 대해서 알아볼 필요가 있는데, 출처마다 조금씩 설명이 다르다. 



### 1) 변수가 할당되는 원리

식별자를 위한 메모리 공간과 실제 값을 따로 할당하고, 식별자 공간에 변수메모리 주소를 할당시켜준다. 

```javascript
var a = 'xyz';
```

1. var a  변수가 어느 메모리(1001)에 선언된다. 
2. xyz 라는 텍스트가 다른 어느 메모리(9200)에 선언된다. 
3. var a의 메모리에(1001), 매핑된 값의 메모리주소(9200) 가 저장된다. 



### 2) 변수가 변경되는 원리

변수를 그대로 두고, 새로운 값을 생성하여 매핑된 메모리 주소를 바꾼다. 

```javascript
a = 'pqr';
```

1. 'pqr' 이라는 텍스트가 어느 메모리(6330)에 선언된다.
2. a 에 매핑된 주소 (9200)이 6330 으로 변경된다. 



- 이렇게 일어나는 이유는 재할당이 빈번하게 일어나기 때문이다. 
- 재할당이 일어나면 



### 변수 할당 과정



### 1) 객체지향 자바스크립트

자바스크립트는 아래의 순서대로 실행된다. 

1. 파싱 Parsing
2. 변수, 함수 정의
3. 실행
   1. 함수코드 파싱
   2. 호출




#### (1) 파싱 Parsing

우선 전역레벨의 파싱이 먼저 일어난다. 

파싱은 변수와 함수변수를 초기화하는 과정이다.

전역레벨 -> 함수레벨



#### (2) 변수, 함수 정의 

#### (3) 실행



---



### 2) You don't know JS - 카일 심슨




#### 컴파일

자바스크립트가 컴파일의 과정이 없다고 생각하기 쉬운데, 자바스크립트에는 아주 짧은 컴파일 과정이 존재한다. 

단지 '미리' 컴파일을 해놓지 않고 코드가 실행되기 바로 직전에 컴파일이 실행된다. 



자바스크립트의 컴파일은 3가지 단계로 진행된다.

1. 토크나이징/렉싱 : 문자열을 쪼갬
2. 파싱 : 쪼갠 문자열을 AST 형태로 변환
3. 코드 생성 : AST를 실행코드로 변환

---



##### 1. 토크나이징

​	문자열을 쪼개는 것을 lexing 이라고도 한다. 



##### 2. 파싱 Parsing AST 

```javascript
var a = 2;
```

이걸 실행했을때, AST가 어떻게 그려지는가는 아래 사이트를 보면 된다.

https://resources.jointjs.com/demos/javascript-ast

http://int3.github.io/metajs/

http://www.pythontutor.com/visualize.html#mode=edit



##### 3. 코드 생성 



---



### 3) 내가 정리한 결론



#### 자바스크립트 실행과정 : 선 컴파일, 후 실행

자바스크립트는 실행되기 바로 직전에 컴파일을 먼저 하는데, 적절할 지는 모르겠지만 아래와 같이 비유를 해볼 수 있다. 

- 컴파일 : 접시를 준비하는 것(셋팅)

- 실행 : 접시위에 음식을 옮겨담는 것

순서상으로 볼 때, 자바스크립트 엔진은 컴파일을 다 하고 나서 실행을 한다. 즉, 접시 하나를 준비해서 음식을 담고, 또 다음 접시를 하나 더 꺼내서 다음 음식을 담는 방식이 아니라, 처음부터 접시를 다 깔아놓은 다음(컴파일)에 음식을 올린다(실행)는 말이다. 



#### (1) 선 컴파일 : 키워드를 만나면 정의를 한다.

그렇다면 자바스크립트는 어떻게 컴파일이 되는가? 변수 var test와 함수 function func에는 한가지 공통점이 있는데 식별자 앞에 var와 func 같은 키워드가 붙어있는 것이다. 이 var와 func의 역할은 '내가 변수요', '내가 함수요'라고 알려주기 위한 것으로,  컴파일 과정에서는 키워드를 만났을 때 이 키워드를 참고로 변수 및 함수를 정의한다.   

var 변수의 값은 undefined로 초기화된다. 

그러니까 var a, function func라는 두 개의 접시를 미리 준비하는 것이다.

| keyword  | identifier |
| -------- | ---------- |
| var      | a          |
| function | test       |

- var 없이 변수를 선언하면 컴파일 단계가 아니라, 실행 단계(런타임)에 전역변수 스코프가 정의된다. 




#### (2) 후 실행



#####  정리

1. 프로그램은 실행 전에 컴파일을 한다. 
2. 컴파일 이후에 실행된다.
3. 키워드들은 초기화되어버린다.

---





## var let const

- var : 선언과 동시에 undefined로 초기화 됨. 선언하기 전에 사용 가능. 함수 스코프 사용
- let : 선언은 초기 단계에 이루어지지만, 초기화는 코드에 도달했을때 이루어짐
  블록스코프를 따름. 값을 할당하기 이전에는 해당 스코프에서 사용이 불가능하다는 추가적인 제약을 갖고 있으며,  이런 영역을 TDZ(Temporal Dead Zone) 이라고 부른다. 블록스코프 사용



호이스팅 : 스코프 내부 어디서든 변수 선언이 최상위에 선언된 것처럼 행동