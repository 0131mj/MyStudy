# Immutability - 불변성



불변성.

불변성을 유지해라? 불변은 안변하는 것인데 어떻게 '불변'을 '유지'하라는 말인가???

용어가 조금 헷갈릴수도 있겠는데, '불변성을 유지하라'는 말은 '기존 state를 변경하지 말고', 그 대신 새로운 값으로 대체하라는 말이다. 



객체와 배열은 참조형이다. 

```react
const a = {text:'a'}
const b = a;
b.alias = 'c';

console.log(a); //{text: "a", alias: "c"}
```

그래서 a와 b는 같은 주소를 가리킨다. 

참조형의 비교는, 주소가 같은가를 비교하기 때문에 , 결국 a와 b는 같은 값이 된다. 





## 리액트에서 state 값을 변경하는 법



리액트에서 state의 값을 변경할 때는 두가지 유의사항이 있다. 



### 1. state 직접변경 대신, setState 사용

setState() 함수를 호출하는 것은, "라이프사이클 테크트리를 타겠다" 라고 말해주는 것이다. 

(아마 setState안에 그 일련의 작업들이 포함되어 있는 것 같다. )

그래도 직접 변경하면?  렌더링이 자동으로 되지 않는다. 뿐만 아니라 라이프 사이클에 관련된 함수들을 사용하지도 않는다. 



### 2. 새로운 값을 집어넣기

setState 함수를 이용하되, state에 push를 하지말고 새로운 값을 집어넣으라는 말이다.

리액트는 state의 값이 다른 값으로 '대체' 되었을 경우에만 알아차린다. 

**변경이 아니라, 대체, 즉 재할당이다.** 

```javascript
const obj ={a:1, b:2}
const obj2 = {...obj, c:3}
```

이렇게 처리를 할 경우에,  ...obj는 obj를 통째로 읽어와서 복사한다. 말하자면, 참조형으로 값을 갖고 오는 것이 아니라 복사해서 집어넣어버린다. 그래서 다른 객체로 읽힌다. 





## immutable.js

많이 중첩된 깊은 구조의 객체나 배열일 경우, 스프레드 연산자를 사용하기가 번거롭기 때문에 immutable.js라는 라이브러리를 사용한다. 

